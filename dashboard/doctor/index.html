<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://uicdn.toast.com/calendar/latest/toastui-calendar.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"
      type="text/javascript"
    ></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Doctor Dashboard</title>

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="../../assets/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../../assets/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../../assets/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="../../assets/favicon/site.webmanifest" />

    <link rel="stylesheet" href="css/main.css" />
    <!-- Boxicons CDN Link -->
    <link
      href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css"
      rel="stylesheet"
    />
    
    <link rel="stylesheet" href="path/to/bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="path/to/font-awesome/css/font-awesome.min.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
/* The Modal (background) */
.modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.7);
}

/* Modal Header */
.modal-header {
  padding: 10px;
  background-color: #333;
  color: #fff;
}

/* Close Button */
.close {
  float: right;
  font-size: 24px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover,
.close:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}

/* Modal Body */
.modal-body {
  padding: 20px;
}

/* Google Map */
#map {
  height: 400px;
  width: 100%;
}

/* Box */
.box {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 10px 0;
  padding: 10px;
  background-color: #fff;
  box-shadow: 0 0 5px rgba(0,0,0,0.1);
}

/* Font Awesome Icon */
.cart {
  font-size: 30px;
  color: #333;
  cursor: pointer;
}

}

    </style>
    
       <style>
    /* Styles for the modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
      background-color: #fefefe;
      max-height: 80vh;
      overflow-y: auto;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }
    


  .table-container {
    max-height: 500px; /* Adjust the maximum height as needed */
    overflow-y: auto;
  }
  </style>   
    
    
    
    
    
  </head>

  <body>
    <div class="container" id="blur">
      <div class="sidebar">
        <div class="logo-details"></div>
        <ul class="nav-links">
            
            
          <li class="dash content active">
              <i class="bx bx-grid-alt"></i>
              <span class="links_name">Dashboard</span>
            </a>
          </li>
          
          
          <li class="home content">
              <i class="bx bx-home-alt"></i>
              <span class="links_name">Home</span>
            </a>
          </li>
          
          
          <li class="patient content">
              <i class="fas fa-person" aria-hidden="true"></i>
              <span class="links_name">Patients</span>
            </a>
          </li>
          
          
          <li class="schedule content">
              <i class="bx bx-time"></i>
              <span class="links_name">Schedule</span>
            </a>
          </li>


          <li class="reports content">
              <i class="fa fa-file-pdf-o" aria-hidden="true"></i>
              <span class="links_name">Reports</span>
            </a>
          </li>
          
          
          <li class="camera content">
              <i class="fa fa-camera"></i>
              <span class="links_name">Camera</span>
            </a>
          </li>
          

          <li class="blockchain content">
              <i class="fa fa-btc" aria-hidden="true"></i>
              <span class="links_name">Blockchain</span>
            </a>
          </li>
          
          <li class="log_out">
              <i class="bx bx-log-out"></i>
              <span class="links_name">Log out</span>
            </a>
          </li>
          
        </ul>
      </div>
      <section class="home-section">
        <nav>
          <div class="sidebar-button">
            <i class="bx bx-menu sidebarBtn"></i>
            <span class="dashboard">Dashboard</span>
          </div>
          <div class="logo">
            <img
              src="../../assets/img/logo%20blue%20bg.PNG?raw=true"
              class="logo"
              alt="logo-blue-bg"
              style="width: 50%; height: auto; margin: 15px"
              border="0"
            />
          </div>
          <div class="search-box">
            <input type="text" placeholder="Search..." />
            <i class="bx bx-search"></i>
          </div>
          <div class="profile-details">
            <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png"
            alt="DP" />
            <span class="admin_name">Dr Smith Wright</span>
            <i class="bx bx-chevron-up"></i>
          
            <div class="section-dropdown">
                <a class="sd-list" href="../account/">Account</a>
                <a class="sd-list" href="../documentation/">Documentation</a>
                <a class="sd-list" href="../premium/">Premium</a>
                <a class="sd-list" href="../preference/">Preference</a>
            </div>
          </div>
        </nav>

       
        <div class="box-content main dashboard active" style="background-color:white;">

          <div class="overview-boxes"  >
            
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Total Patients</div>
                <div class="number">23</div>
                <div class="indicator">
                  <i class="bx bx-up-arrow-alt"></i>
                  <span class="text">Up from yesterday</span>
                </div>
              </div>
              <i class="fas fa-person cart two" aria-hidden="true"></i>
            </div>
            
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Total Appointments</div>
                <div class="number">36</div>
                <div class="indicator">
                  <i class="bx bx-up-arrow-alt"></i>
                  <span class="text">For Today</span>
                </div>
              </div>
              <i id="openModalBtn" class="fas fa-calendar cart" aria-hidden="true"></i>
            </div>


            <div class="box">
              <div class="right-side">
                <div class="box-topic">Total Staff</div>
                <div class="number">246</div>
                <div class="indicator">
                  <i class="bx bx-up-arrow-alt"></i>
                  <span class="text">Up from yesterday</span>
                </div>
              </div>
              <i class="fas fa-user-tie cart three" aria-hidden="true"></i>
            </div>

            <div class="box">
              <div class="right-side">
                <div class="box-topic">Total Beds</div>
                <div class="number">1000</div>
                <div class="indicator">
                  <i class="bx bx-down-arrow-alt down"></i>
                  <span class="text">Down From Today</span>
                </div>
              </div>
              <i class="fas fa-bed cart four" aria-hidden="true"></i>
            </div> 
          </div>
          <div class="doc-box">
            <div class="right-side">
              <img class="doc-img" src="../../assets/img/doctors/doctors-2.jpg" alt="">
              <div class="box-topic admin_name">Dr Smith Wright</div>
              <p class="text">Orthopedic Specialist</p>
            </div>
          </div>

          


          <div class="appointment">
            
          </div>
          
        </div>
        

        <div class="box-content home dashboard">
          <div class="sales-boxes">
            <div class="recent-sales">
              <div class="sales-details box">
                <ul class="details">
                  <li class="topic">Patients</li>
            Alex Doe</a></li>
                  <li><a href="#">David Mart</a></li>
                  <li><a href="#">Roe Parter</a></li>
                  <li><a href="#">Diana Penty</a></li>
                  <li><a href="#">Diana Penty</a></li>
                  <li><a href="#">Martin Paw</a></li>
                  <li><a href="#">Doe Alex</a></li>
                  <li><a href="#">Aiana Lexa</a></li>
                  <li><a href="#">Rexel Mags</a></li>
                </ul>
                <ul class="details">
                  <li class="topic">Age</li>
                  <li><a href="#">34</a></li>
                  <li><a href="#">24</a></li>
                  <li><a href="#">64</a></li>
                  <li><a href="#">54</a></li>
                  <li><a href="#">23</a></li>
                  <li><a href="#">54</a></li>
                  <li><a href="#">13</a></li>
                  <li><a href="#">25</a></li>
                  <li><a href="#">26</a></li>
                </ul>
                <ul class="details">
                  <li class="topic">Gender</li>
                  <li><a href="#">Male</a></li>
                  <li><a href="#">Male</a></li>
                  <li><a href="#">Male</a></li>
                  <li><a href="#">Female</a></li>
                  <li><a href="#">Female</a></li>
                  <li><a href="#">Male</a></li>
                  <li><a href="#">Male</a></li>
                  <li><a href="#">Female</a></li>
                  <li><a href="#">Male</a></li>
                </ul>
                <ul class="details">
                  <li class="topic">Diagonsed</li>
                  <li><a href="#">CBC</a></li>
                  <li><a href="#">CDX X-Ray</a></li>
                  <li><a href="#">CRPCS</a></li>
                  <li><a href="#">CBC</a></li>
                  <li><a href="#">CDX X-Ray</a></li>
                  <li><a href="#">CRPCS</a></li>
                  <li><a href="#">CBC</a></li>
                  <li><a href="#">CDX X-Ray</a></li>
                  <li><a href="#">CRPCS</a></li>
                </ul>
                <ul class="details">
                  <li class="topic">Reports</li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                  <li>
                    <a href="#"><u>View</u></a>
                  </li>
                </ul>
              </div>
              <div class="button">
                <a href="#">See All</a>
              </div>
            </div>
          </div>
          
        </div>

        <div class="box-content patient dashboard ">

          <div class="search-box">
            <select name="" id="search_select" >
              <option value="" selected disabled>--select a patient--</option>
            </select>
              <button id="search_button"><i class="bx bx-search"></i></button>
              
          </div>
          
          <div class="patient-box">
            <div class="box-topic name"></div>
            <p class="text"> Age: <span class="age"></span></p>
            <p class="text"> Date of Birth: <span class="dob"></span></p>
            <p class="text"> Address: <span class="add"></span></p>
          </div>
          <div class="overview-boxes">     
            <div class="box">
              <div class="right-side">
                <div class="box-topic">chills</div>
                <div class="number chills"></div>
                <div class="indicator">
                  <span class="text"> Safe: false</span>
                </div>
              </div>
              <i
                class="cart"
                style="font-size: 50px; font-style: initial; font-weight: bold"
                >❄</i
              >
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Diastole BP</div>
                <div class="number dbp"></div>
                <div class="indicator">
                  <span class="text">Safe [60 - 80 mm Hg]</span>
                </div>
              </div>
              <i class="fas fa-heart cart two"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Systole BP</div>
                <div class="number sbp"></div>
                <div class="indicator">
                  <span class="text">Safe [90 - 120 mm Hg]</span>
                </div>
              </div>
              <i class="fas fa-heart cart three"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">HeartRate</div>
                <div class="number heartrate"></div>
                <div class="indicator">
                  <span class="text">Safe [60 to 100 beats]</span>
                </div>
              </div>
              <i class="fas fa-heartbeat cart four"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Respiration Rate</div>
                <div class="number respiration"></div>
                <div class="indicator">
                  <span class="text">Safe [12 to 16 breaths/min]</span>
                </div>
              </div>
              <i class="fas fa-lungs cart two"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">SpO2</div>
                <div class="number spo2"></div>
                <div class="indicator">
                  <span class="text">Range [95% or higher]</span>
                </div>
              </div>
              <i class="fas fa-wind cart three"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Blood Group</div>
                <div class="number bloodg"></div>
                <div class="indicator">
                  <span class="text"></span>
                </div>
              </div>
              <i class="fas fa-droplet cart four"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Temperature</div>
                <div class="number temp"></div>
                <div class="indicator">
                  <span class="text">Range [97°F to 99°F]</span>
                </div>
              </div>
              <i class="fa-solid fa-temperature-half cart"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Ambulation</div>
                <div class="number ambulation"></div>
                <div class="indicator">
                  <span class="text">Values possible : True/False</span>
                </div>
              </div>
              <i class="fa-solid fa-face-thermometer"></i>
              <i class="fas fa-syringe cart three"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Fever History</div>
                <div class="number fever"></div>
                <div class="indicator">
                  <span class="text">Values possible : Yes/No/Other</span>
                </div>
              </div>
              <i class="fas fa-temperature-half cart four"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">BMI</div>
                <div class="number bmi"></div>
                <div class="indicator">
                  <span class="text">Range [18.5 to 24.9]</span>
                </div>
              </div>
              <i class="fas fa-balance-scale cart"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">FiO2</div>
                <div class="number fio2"></div>
                <div class="indicator">
                  <span class="text">Range [50 to 100]</span>
                </div>
              </div>
              <i class="fas fa-lungs cart two"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Emotion</div>
                <div class="number emotion"></div>
                <div class="indicator">
                  <span class="text">Values Possible:happy/neutral/sad</span>
                </div>
              </div>
              <i class="fa-sharp fa-solid fa-face-smile cart two"></i>
            </div>
            <div class="box">
              <div class="right-side">
                <div class="box-topic">Location</div>
                <div class="location"></div>
                <div class="number city-name"></div>
                <div class="indicator">
                
                  <span class="text">GPS + City</span>
                 
                </div>
              </div>
              <i class="fa-solid fa-location-dot cart two" id="open-map"></i>
            </div>
          </div>
        </div>
      
        <div class="schedule dashboard">
          <div id="calendar" class="calendar-box"></div>
        </div>

        <div class="reports dashboard">

            <iframe style="height: 100%; width: 100%; border: none;" src="https://health.aiiot.website/dashboard/modules/reports/index.php"></iframe>

        </div>


        <div class="camera dashboard">

            <iframe style="height: 100%; width: 100%; border: none;" src="https://detectron-vmercel.vercel.app/" allow="camera *; microphone *"></iframe>

        </div>

        <div class="blockchain dashboard">

            <iframe style="height: 100%; width: 100%; border: none;" src="https://health.aiiot.website/blockchainreport/doctor.php" ></iframe>

        </div>
        
<!-- Modal -->
<div id="map-modal" class="modal" style="margin-top:10%;">
  <div class="modal-header">
    <span class="close">&times;</span>
  </div>
  <div class="modal-body">
    <div id="map"></div>
  </div>
</div>     
  


<!-- HTML code for the modal -->
<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div class="table-container">
    <table id="appointmentsTable">
      <thead>
        <tr>
          <th>Appointment ID</th>
          <th>Patient ID</th>
          <th>Doctor ID</th>
          <th>Appointment Date</th>
          <th>Appointment Time</th>
          <th>Service Type</th>
          <th>Service Description</th>
          <th>Appointment Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    </div>
  </div>
</div>

<!-- JavaScript code to populate the table with data from the database -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  // Function to fetch appointments from the database and populate the table
  function populateAppointmentsTable() {
    $.ajax({
      url: 'fetch_appointment.php',
      type: 'GET',
      success: function(response) {
        console.log("APPOINTMENTS FETCHED: ",response.appointments[0]);
        var appointments = response.appointments;
        var tableBody = $('#appointmentsTable tbody');
        tableBody.empty();
        
        // Iterate through the appointments and populate the table rows
        for (var i = 0; i < appointments.length; i++) {
          var appointment = appointments[i];
          var row = $('<tr>');
          row.append($('<td>').text(appointment.appointment_id));
          row.append($('<td>').text(appointment.patient_id));
          row.append($('<td>').text(appointment.doctor_id));
          row.append($('<td>').text(appointment.appointment_date));
          row.append($('<td>').text(appointment.appointment_time));
          row.append($('<td>').text(appointment.service_type));
          row.append($('<td>').text(appointment.service_description));
          
          // Create the status dropdown with options and set the current status as selected
          var statusCell = $('<td>');
          var statusDropdown = $('<select>').addClass('status-dropdown');
          var options = ['pending', 'confirmed', 'completed'];
          for (var j = 0; j < options.length; j++) {
            var option = $('<option>').text(options[j]);
            if (options[j] === appointment.appointment_status) {
              option.attr('selected', 'selected');
            }
            statusDropdown.append(option);
          }
          statusCell.append(statusDropdown);
          row.append(statusCell);
          
          // Create the action buttons
          var actionsCell = $('<td>');
          var editButton = $('<button>').text('Edit').addClass('edit-button');
          var saveButton = $('<button>').text('Save').addClass('save-button');
          var deleteButton = $('<button>').text('Delete').addClass('delete-button');
          actionsCell.append(editButton, saveButton, deleteButton);
          row.append(actionsCell);
          
          // Append the row to the table body
          tableBody.append(row);
        }
      },
      error: function(xhr, status, error) {
        console.error('Request failed with status:', status);
        // Handle the error case appropriately
      }
    });
  }
  
  // Handle the click event of the Edit button
  $(document).on('click', '.edit-button', function() {
    var row = $(this).closest('tr');
    var appointmentID = row.find('td:eq(0)').text();
    var patientID = row.find('td:eq(1)').text();
    var doctorID = row.find('td:eq(2)').text();
    var appointmentDate = row.find('td:eq(3)').text();
    var appointmentTime = row.find('td:eq(4)').text();
    var serviceType = row.find('td:eq(5)').text();
    var serviceDescription = row.find('td:eq(6)').text();
    var appointmentStatus = row.find('.status-dropdown').val();

    // Convert the appointment row into an editable form
    row.find('td:eq(0)').html('<input type="text" class="edit-appointment-id" value="' + appointmentID + '">');
    row.find('td:eq(1)').html('<input type="text" class="edit-patient-id" value="' + patientID + '">');
    row.find('td:eq(2)').html('<input type="text" class="edit-doctor-id" value="' + doctorID + '">');
    row.find('td:eq(3)').html('<input type="date" class="edit-appointment-date" value="' + appointmentDate + '">');
    row.find('td:eq(4)').html('<input type="time" class="edit-appointment-time" value="' + appointmentTime + '">');
    row.find('td:eq(5)').html('<input type="text" class="edit-service-type" value="' + serviceType + '">');
    row.find('td:eq(6)').html('<textarea class="edit-service-description">' + serviceDescription + '</textarea>');
    row.find('td:eq(7)').html('<select class="edit-appointment-status"><option value="pending">Pending</option><option value="confirmed">Confirmed</option><option value="completed">Completed</option></select>');
    row.find('.edit-appointment-status').val(appointmentStatus);

    // Replace the Edit button with the Save button
    row.find('.edit-button').replaceWith('<button class="save-button">Save</button>');
  });

  // Handle the click event of the Save button
  $(document).on('click', '.save-button', function() {
    var row = $(this).closest('tr');
    var appointmentID = row.find('.edit-appointment-id').val();
    var patientID = row.find('.edit-patient-id').val();
    var doctorID = row.find('.edit-doctor-id').val();
    var appointmentDate = row.find('.edit-appointment-date').val();
    var appointmentTime = row.find('.edit-appointment-time').val();
    var serviceType = row.find('.edit-service-type').val();
    var serviceDescription = row.find('.edit-service-description').val();
    var appointmentStatus = row.find('.edit-appointment-status').val();

    // Send an AJAX request to update the appointment record in the database
    $.ajax({
      url: 'update_appointment.php',
      type: 'POST',
      data: {
        appointmentID: appointmentID,
        patientID: patientID,
        doctorID: doctorID,
        appointmentDate: appointmentDate,
        appointmentTime: appointmentTime,
        serviceType: serviceType,
        serviceDescription: serviceDescription,
        appointmentStatus: appointmentStatus
      },
      success: function(response) {
        // Handle the success case appropriately
        console.log('Appointment updated successfully');

        if(appointmentStatus==="confirmed"){
                // Send the AJAX request
                $.ajax({
                  url: '../../api/main.php',
                  type: 'GET',
                  data: {
                    appointID: appointmentID,
                    appointDate: appointmentDate,
                    appointTime: appointmentTime,
                    appointDateTime : appointmentDate + ' '+ appointmentTime
                  },
                  success: function(response) {
                    console.log(response); // Log the response to inspect its content
                
                    // Handle the success response
                    console.log('Appointment Email Confirmation sent successfully');
                  },
                  error: function(xhr, status, error) {
                    // Handle the error response
                    console.log('Error sending appointment Email Confirmation: ' + error);
                  }
                });
   
        }

        // Refresh the table to show the updated data
        populateAppointmentsTable();
      },
      error: function(xhr, status, error) {
        console.error('Request failed with status:', status);
        // Handle the error case appropriately
      }
    });
  });

  // Handle the click event of the Delete button
  $(document).on('click', '.delete-button', function() {
    var row = $(this).closest('tr');
    var appointmentID = row.find('td:eq(0)').text();

    // Send an AJAX request to delete the appointment record from the database
    $.ajax({
      url: 'delete_appointment.php',
      type: 'POST',
      data: {
        appointmentID: appointmentID
      },
      success: function(response) {
        // Handle the success case appropriately
        console.log('Appointment deleted successfully');
        // Refresh the table to show the updated data
        populateAppointmentsTable();
      },
      error: function(xhr, status, error) {
        console.error('Request failed with status:', status);
        // Handle the error case appropriately
      }
    });
  });

  // Function to close the modal
  function closeModal() {
    $('#myModal').hide();
  }

  // Handle the click event of the close button
  $(document).on('click', '.close', function() {
    closeModal();
  });

  // Call the function to populate the appointments table when the modal is shown
  $('#myModal').on('shown.bs.modal', function() {
    populateAppointmentsTable();
  });

  // Call the function to close the modal when the Escape key is pressed
  $(document).keyup(function(e) {
    if (e.key === "Escape") {
      closeModal();
    }
  });
</script>



  <script>
    $(document).ready(function() {
      // Get the modal element
      var modal = document.getElementById("myModal");

      // Get the button that opens the modal
      var btn = document.getElementById("openModalBtn");

      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];

      // Function to open the modal
      function openModal() {
        modal.style.display = "block";
        populateAppointmentsTable();
      }

      // Function to close the modal
      function closeModal() {
        modal.style.display = "none";
      }

      // Event listener for button click to open the modal
      btn.onclick = openModal;

      // Event listener for close button click to close the modal
      span.onclick = closeModal;

      // Event listener for clicking outside the modal to close it
      window.onclick = function(event) {
        if (event.target === modal) {
          closeModal();
        }
      };
    });
  </script>






        
      </section>
       <!-- 
      <footer style="margin-top:20%;">
        <div class="container-fluid bg-dark text-light py-3">
          <div class="row">
            <img
              src="../../assets/img/logo%20blue%20bg.PNG?raw=true"
              class="logo"
              alt="logo-blue-bg"
              style="width: 15%; display: block; height: auto; margin: auto"
              border="0"
            /><br>
            <small style="margin-left:43%;>Copyright &copy; <span id="year" "></span> AI and Robotics
              Institute, NEU</small
            >
          </div>
        </div>
      </footer>
      
      
    </div> -->
  <!-- <div id="popup">
    <div data-role="popup" id="popupBot" data-overlay-theme="b" data-theme="a" data-tolerance="15,15"
      class="ui-content">
      <iframe src='https://dodxtx.shinyapps.io/EMSC/' width="1000px" height="500px" sandbox=""></iframe>
    </div>
  </div> -->
      <script src="https://uicdn.toast.com/calendar/latest/toastui-calendar.ie11.min.js"></script>
      <!-- <script src="assets/js/script.js"></script> -->
      <script src="js/nav.js"></script>
      <script src="js/sidebar.js"></script>
      <script src="js/index.js"></script>
      <script src="js/calendar.js"></script>
      
      <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
      <script
        src="https://kit.fontawesome.com/1ed7106697.js"
        crossorigin="anonymous"
      ></script>
      
      <script>
        // Set the current year in the copyright notice
        const currentYear = new Date().getFullYear();
        document.getElementById("year").innerHTML = currentYear;
      </script>
      
      
<script>

// Set the latitude and longitude for the map marker
var markerLatLng = {lat: latitude, lng: longitude}; // Replace with your coordinates

// When the font awesome icon is clicked, open the modal
document.getElementById("open-map").addEventListener("click", function() {
  document.getElementById("map-modal").style.display = "block";
  
  // Load the Google Maps API
  var script = document.createElement("script");
  script.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyBJuXxmGpIbBHS8JFeuD4DRVm1I4EaOqzI";
  document.head.appendChild(script);

  // Create the Google Map
  script.onload = function() {
    var mapOptions = {
      center: markerLatLng,
      zoom: 12 // Adjust the zoom level
    };
    var map = new google.maps.Map(document.getElementById("map"), mapOptions);
    
    // Add marker to the map
    var marker = new google.maps.Marker({
      position: markerLatLng,
      map: map,
      title: "Marker title" // Replace with your marker title
    });
    
    
  // Fetch coordinates from the location table in the database and plot them on the map
  // Replace 'fetch_coordinates.php' with the appropriate server-side script
  $.ajax({
    url: 'https://health.aiiot.website/api/main.php/',
    type: 'GET',
    data:{
        theUser: 'doctor',
        action:'fetchCoordinates',
    },
    success: function(response) {
      console.log("RESPONSE: ",response);
      var coordinates = response.coordinates;
      console.log("COORDINATES: ", coordinates);
      var marker;
      for (var i = 0; i < coordinates.length; i++) {
        var latLng = new google.maps.LatLng(coordinates[i].latitude, coordinates[i].longitude);
        marker = new google.maps.Marker({
          position: latLng,
          map: map
        });
      }
      if (marker) {
        map.setCenter(marker.getPosition());
      }
    },
    error: function(xhr, status, error) {
      console.error('Request failed with status:', status);
      // Handle the error case appropriately
    }
  });
    
    
    
  };
});

// When the user clicks on <span> (x), close the modal
document.getElementsByClassName("close")[0].addEventListener("click", function() {
  document.getElementById("map-modal").style.display = "none";
});

console.log(latitude)
</script>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
$(document).ready(function() {


    $(".admin_name").text(sessionStorage.displayName);

});
</script>



  
  </body>
</html>
<!-- -->
